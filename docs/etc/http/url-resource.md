---
title: 2. URL과 리소스
category:
  - etc.
tag:
  - Http
---

URL(Uniform Resource Locator)은 인터넷의 리소스를 가리키는 표준이름이다.
URL은 전자정보 일부를 가리키고 그것이 어디에 있고 어떻게 접근할 수 있는지 알려준다.
이번 포스트에서는 다음과 같은 것들을 다룬다.

- URL 문법, 여러 URL 컴포넌트가 어떤 의미를 가지며 무엇을 수행하는지
- 여러 웹 클라이언트가 지원하는 상대 URL과 확장 URL 같은 단축 URL에 대해서
- URL의 인코딩과 문자 규칙
- 여러 인터넷 정보 시스템에 적용되는 공통 URL 스킴

## 인터넷의 리소스 탐색하기

HTTP 명세에서는 URI를 더 일반화된 개념의 리소스 식별자로 사용한다.
하지만 실제로 HTTP 애플리케이션은 URL을 URI의 한 부분으로 취급한다.
HTTP 완벽 가이드에서는 URI와 URL을 번갈아 사용할 것이지만 대부분 URL을 가리키는 것으로 보면된다.

<http://www.joes-hardware.com/seasonal/index-fall.html> 이라는 URL을 불러오고 싶다고 해보자.

![그림 2-1. URL이 브라우저, 서버, 서버 파일 시스템의 위치와 어떻게 연결되는지 보여준다.](https://github.com/Zamoca42/blog/assets/96982072/61cbaf07-9aaa-4cfb-a5ae-bb52e0f4244d)

URL은 HTTP 프로토콜이 아닌 다른 가용한 프로토콜을 사용할 수도 있다.

```text
mailto:president@whitehouse.gov
```

위 형식은 이메일 주소를 가리키며

```text
ftp://ftp.lots-o-books.com//pub/complete-price-list.xls
```

위 형식은 FTP(File Transfer Protocol) 서버에 올라가 있는 파일을 가리키고

```text
rtsp://www.joes-hardware.com:554/interview/cto_video
```

위 형식은 스트리밍을 제공하기 위해 비디오 서버에 호스팅하고 있는 영화를 가리킨다.
이렇게 URL은 인터넷에 있는 어떤 리소스든지 가리킬 수 있다.

대부분의 URL은 동일하게 '스킴://서버위치/경로' 구조로 이루어져 있다.
따라서 인터넷상의 모든 리소스를 가리키고 가져오기위해,
그리고 모든 사람이 같은 방식으로 이름을 써서 리소스를 찾을 수 있도록,
단일 방식의 작명 규칙을 가진 것이다.

## URL 문법

URL로 인터넷상의 모든 리소스를 찾을 수 있지만, 그 리소스들은 다른 스킴을 통해 접근할 수 있으며,
URL 문법은 스킴에 따라 달라진다.

다른 URL 스킴을 사용한다는 것이 전혀 다른 문법을 사용한다는 뜻일까?
사실은 그렇지 않다. 대부분의 URL은 일반 URL 문법을 따르며, 서로 다른 URL 스킴도 형태와 문법 면에서 매우 유사하다.

대부분의 URL 스킴의 문법은 일반적으로 9개 부분으로 나뉜다.

```text
<스킴>://<사용자 이름>:<비밀번호>@<호스트>:<포트>/<경로>;<파라미터>?<질의>#<프래그먼트>
```

### 1. 스킴: 사용할 프로토콜

스킴은 주어진 리소스에 어떻게 접근하는지 알려주는 중요한 정보다.
이는 URL을 해석하는 애플리케이션이 어떤 프로토콜을 사용하여 리소스를 요청해야 하는지 알려준다.

### 2. 호스트와 포트

애플리케이션이 인터넷에 있는 리소스를 찾으려면,
리소스를 호스팅하고 있는 장비와 그 장비 내에서 리소스에 접근할 수 있는 서버가 어디에 있는지 알아야 한다.
URL의 호스트와 포트 컴포넌트는 그 두 가지 정보를 제공해준다.
예를 들어, 아래 두 개의 URL은 같은 리소스를 가리킨다.

```text
http://www.joes-hardware.com:80/index.html
http://161.58.228.45:80/index.html
```

### 3. 사용자 이름과 비밀번호

많은 서버가 자신이 가지고 있는 데이터에 접근을 허용하기 전에 사용자 이름과 비밀번호를 요구한다. FTP 서버가 좋은 예다.

```text
ftp://ftp.prep.ai.mit.edu/pub/gnu
ftp://anonymous:my_passwd@ftp.prep.ai.mit.edu/pub/gnu
```

애플리케이션이 FTP와 같이 사용자 일므과 비밀번호를 요구하는 URL 스킴을 사용한다면,
그 값들이 삽입되어 있지 않은 경우 기본 사용자 이름과 비밀번호 값을 넣어 놓을 것이다.

예를 들어, 사용자 이름과 비밀번호를 기술하지 않고 FTP URL에 접근하면,
기본 사용자 이름 값으로 'anonymous'가, 비밀번호는 브라우저마다 가지고 있는 기본값으로 사용한다.

### 4. 경로

URL의 경로 컴포넌트는 리소스가 서버의 어디에 있는지 알려준다.
해당 경로는 아래 예와 같이 계층적 파일 시스템 경로와 유사한 구조를 가진다.

```text
http://www.joes-hardware.com:80/seasonal/index-fall.html
```

이 URL의 경로는 '/seasonal/index-fall.html'로 유닉스 파일 시스템의 파일 경로와 유사하다.
경로는 서버가 리소스의 위치를 찾는데 사용하는 정보다.
UTTP URL에서 경로 컴포넌트는 `/` 문자를 기준으로 경로조각으로 나뉜다.
각 경로조각은 자체만의 파라미터 컴포넌트를 가질 수 있다.

### 5. 파라미터

URL의 파라미터 컴포넌트는 애플리케이션이 서버에 정확한 요청을 하기 위해 필요한 입력 파라미터를 받는데 사용한다.
이 컴포넌트는 이름/값 쌍의 리스트로 URL 나머지 부분들로부터 `;` 문자로 구분하여 URL에 기술한다.
이를 통해 애플리케이션이 리소스에 접근하는데 필요한 어떤 추가 정보든 전달할 수 있다.

```text
ftp://prep.ai.mit.edu/pub/gnu;type=d
```

이 경우 이름은 'type'이고, 값은 'd'인 type=d라는 단 한 개의 파라미터를 전달한다.
파라미터는 경로 조각마다 자체 파라미터를 가질 수 있다.

```text
http://www.joes=hardware.com/hammers;sale=false/index.html;graphics=true
```

위 URL에는 hammers와 index.html이라는 두 개의 경로조각이 있다.
hammers 경로조각은 값이 false인 sale이라는 파라미터를 가진다.
index.html 경로조각은 값이 true인 graphics란 파라미터를 가진다.

### 6. 쿼리스트링

데이터베이스 같은 서비스들은 요청받을 리소스 형식의 범위를 좁히기 위해서 질문이나 질의를 받을 수 있다.
죠의 컴퓨터 가게가 판매되지 않은 상품의 재고 리스트가 있고, 어떤 상품들이 비축되어있는지 조회할 수 있다고 해보자.
다음 URL은 아이템 번호 12731의 재고가 있는지 확인하기 위해 웹 데이터베이스 게이트웨이에 질의하는데 사용된다.

```text
http://www.joes-hardware.com/inventory-check.cgi?item=12731
```

URL의 물음표(?)의 우측에 있는 값들을 쿼리 컴포넌트라고 부른다.
쿼리 컴포넌트는 게이트웨이를 가리키는 URL의 경로 컴포넌트와 함께 전달하고있다.

![그림 2-2. 쿼리스트링은 게이트웨이 애플리케이션으로 전달된다.](https://github.com/Zamoca42/blog/assets/96982072/c8df28ed-8e53-4e1b-8244-52b6a432e4d7)

사용하면 안되는 특정 문자들을 제외하고는 쿼리 컴포넌트 포맷에 제약사항은 없다.
편의상 많은 게이트웨이가 '&'으로 나뉜 '이름=값' 형식의 쿼리스트링을 원한다.

### 7. 프래그먼트

HTML같은 리소스 형식들은 본래의 수준보다 더 작게 나뉠 수 있다.
예를 들어 절(paragraph)이 포함된 용량이 큰 한 개의 텍스트 문서의 경우, 그 리소스에 대한 URL은 텍스트 문서를 가리키겠지만,
이상적으로는 리소스 안에 있는 특정 절을 가리킬 수 있어야한다.

리소스의 특정 부분을 가리킬 수 있도록, URL은 리소스 내의 조각을 가리킬 수 있는 프래그먼트 컴포넌트를 제공한다.
프래그먼트는 URL의 오른쪽에 # 문자에 이어서 온다.

```text
http://www.joes-hardware.com/tools.html#drills
```

위 예에서 drills라는 프래그먼트는 죠의 컴퓨터 가게 웹 서버에 위치한 /tools.html 웹페이지의 일부를 가리킨다.
그 부분을 'drills'라고 기술하였다.

![그림 2-3. 서버는 객체를 전체 단위로만 전승하기 때문에 URL 프래그먼트 클라이언트에서만 사용된다.](https://github.com/Zamoca42/blog/assets/96982072/a8974125-d966-483c-9f4b-4f3abb7a6fae)

## 단축 URL

웹 클라이언트는 몇몇 단축 URL을 인식하고 사용한다.
상대 URL은 리소스 안에 있는 리소스를 간결하게 기술하는데 사용할 수 있다.

### 상대 URL

URL은 상대 URL과 절대 URL 두 가지로 나뉜다.
지금까지 우리가 본 것들은 절대 URL뿐이었다. 절대 URL은 리소스에 접근하는데 필요한 모든 정보를 가지고 있다.

그와 달리 상대 URL은 모든 정보를 담고 있지는 않다. 상대 URL로 리소스에 접근하는데 필요한 모든 정보를 얻기 위해서는
기저(base)라고 하는 다른 URL을 사용해야한다.

상대 URL은 URL을 짧게 표기하는 방식이다.

![예 2-1. 상대 URL을 포함한 HTML 조각](https://github.com/Zamoca42/blog/assets/96982072/756412e7-7947-4125-a29b-e2774f35af2f)

예 2-1의 경우 기저 URL은 다음과 같다.

![그림 2-4. 기저 URL의 사용](https://github.com/Zamoca42/blog/assets/96982072/4c00a963-5979-4dde-af14-a9ca08425c65)

상대 URL은 프래그먼트이거나 URL 일부다.
URL을 처리하는 브라우저 같은 애플리케이션은 상대 URL과 절대 URL 간에 상호 변환을 할 수 있어야한다.

#### 기저 URL

변환 과정의 첫 단계는 기저 URL을 찾는 것이다.
기저 URL은 상대 URL의 기준이 된다.

#### 리소스에서 명시적으로 제공

어떤 리소스들은 기저 URL을 명확하게 기술하기도 한다.
예를 들어 HTML 문서에서는 그 안에 있는 모든 상대 URL을 변경하기 위해서 기저 URL을 가리키는
HTML 태그를 기술할 수 있다.

#### 상대 참조 해석하기

![그림 2-5. 상대 URL을 절대 URL로 변환하기](https://github.com/Zamoca42/blog/assets/96982072/0b1477b3-8e17-485b-86a3-ea7ef2ed2db5)

## 안전하지 않은 문자

URL은 잘 호환되도록 설계되었다. 그리고 URL은 인터넷에 있는 모든 리소스가 여러 프로토콜을 통해서 전달될 수 있도록,
각 리소스에 유일한 이름을 지을 수 있게 설계되었다.
모든 프로토콜이 데이터를 전송하기 위해서 서로 다른 장치를 가지고 있기 때문에,
어떤 프로토콜을 통해서 안전하게 전송될 수 있도록 URL을 설계하는 것은 중요했다.

안전한 전송이란, 정보가 유실될 위험 없이 URL을 전송할 수 있다는 것을 의미한다.
전자메일에 사용되는 SMTP(Simple Mail Transfer Protocol)같은 프로토콜은 특정 문자를 제거할 수도 있는 전송 방식을 사용한다.
문자가 제거되는 일을 피하고자 URL은 상대적으로 작고 일반적으로 안전한 알파벳 문자만 포함하도록 허락한다.

### URL 문자 집합

컴퓨터 시스템의 기본 문자 집합은 보통 영어 중심으로 설정되어 있다.
역사적으로 많은 컴퓨터 애플리케이션이 US-ASCII 문자 집합을 사용해왔다.
US-ASCII는 문자를 서식화하고 하드웨어상에서 신호를 주고받기 위해,
7비트를 사용하여 영문 자판에 있는 키 대부분과 몇몇 출력되지 않는 제어 문자를 표현한다.

US-ASCII는 만들어진 지 오래된 문자 집합이기 때문에, 적은 수의 문자만을 포함하고 있다.
미국 시민들 사이에서는 편리하게 쓰이고 있기는 하지만,
전 세계 십수억의 사람들이 사용하는 유럽 언어나 수백 가지의 비 라틴계 언어들에 존재하는 변형된 문자들까지 US-ASCII가 지원하지는 않는다.

그뿐만 아니라 URL이 특정 이진 데이터를 포함해야하는 경우도 있다.
이런 것들을 지원하기 위해서 URL 설계자들은 URL에 이스케이프 문자열을 쓸 수 있게 설계하였다.
이스케이프 문자열은 US-ASCII에서 사용이 금지된 문자들로, 특정 문자나 데이터를 인코딩할 수 있게 함으로써 이동성과 완성도를 높였다.

### 인코딩 체계

안전한 문자 집합을 이용하는 경우 그 표현의 한계를 넘기 위해, URL에 있는 안전하지 않은 문자들을 표현할 수 있는 인코딩 방식이 고안되었다.
인코딩은 안전하지 않은 문자를 퍼센티지 기호(%)로 시작해, ASCII 코드로 표현되는 두 개의 16진수 숫자로 이루어진 '이스케이프' 문자로 바꾼다.

| 문자    | ASCII 코드 | URL의 예                                               |
| ------- | ---------- | ------------------------------------------------------ |
| ~       | 126 (0x7E) | <http://www.joes-hardware.com/%7Ejoe>                  |
| 빈 문자 | 32 (0x20)  | <http://www.joes-hardware.com/more%20tools.html>       |
| %       | 37 (0x25)  | <http://www.joes-hardware.com/100%26satisfaction.html> |

### 문자 제한

몇몇 문자는 URL 내에서 특별한 의미로 예약되어 있다. 어떤 문자는 US-ASCII의 출력 가능한 문자 집합에 포함되어 있지 않다.
그리고 어떤 문자는 몇몇 인터넷 게이트웨이와 프로토콜에서 혼동되는 것으로 알려져 있어서, 사용이 꺼려지기도 했다.
URL에서 예약된 문자들을 본래의 목적이 아닌 다른 용도로 사용하려면, 그 전에 반드시 인코딩해야 하는 문자들을 나열해 놓았다.

| 문자             | 선점 및 제한                                                                       |
| ---------------- | ---------------------------------------------------------------------------------- |
| %                | 인코딩된 문자에 사용할 이스케이프 토큰으로 선점                                    |
| /                | 경로 컴포넌트에 있는 경로 세그먼트를 나누는 용도로 선점                            |
| .                | 경로 컴포넌트에서 선점                                                             |
| ..               | 경로 컴포넌트에서 선점                                                             |
| #                | 프래그먼트의 구획 문자로 선점                                                      |
| ?                | 질의 문자열의 구획 문자로 선점                                                     |
| ;                | 파라미터의 구획 문자로 선점                                                        |
| :                | 스킴, 사용자 이름/비밀번호, 호스트/포트의 구획 문자로 선점                         |
| $, +             | 선점                                                                               |
| @ & =            | 특정 스킴에서 특별한 의미가 있기 때문에 선점                                       |
| { } \| \ ~ [ ] ` | 게이트웨이와 같은 여러 전송 에이전트에서 불안전하게 다루기 때문에 제한됨           |
| < > \"           | 안전하지 않음. URL 범위 밖에서 역할이 있는 문자이기 때문에 반드시 인코딩해야 한다. |
